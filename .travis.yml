language: node_js
before_install:
- phantomjs --version
- npm install -g grunt-cli grunt-init bower
- bower install
branches:
  only:
  - master
node_js:
- '0.10'
before_script:
- git config --global user.name "Jichao Ouyang"
- git config --global user.email "oyanglulu@gmail.com"
- export REPO_URL="https://$GH_TOKEN@github.com/jcouyang/jcouyang.github.com.git"
script:
- grunt-init config
- npm test
after_success:
- node crawl
- grunt sitemap
- git remote add blogist $REPO_URL
- git checkout -B master
- git rm .travis.yml -f
- git add sitemap.xml index.html javascripts bower_components -f
- git add CNAME
- git add gist atom.xml -f
- git commit -am 'publi:ship:'
- git push blogist master -f -q
env:
  global:
    secure: Whl1uX9FO2U4VCRITPb3embJ2ZFzpFrpy0f8TWbkMfAYlQDjSto7crUr060FNzcT/V4QGopaOW0vqlNGVH9NBaL1eIP6tM0I2iE9zCZfUSbL9XOzfyV+nWa5ebUe+GCpCMU92K3u1Wv5odcWNPwFbOX+ajfAcUCrY3Yxbq5I3cA=
